window.optimizely=window.optimizely||[];var ttcModule=function(){var t={start:"start_ttc",stop:"stop_ttc"},n=function(){localStorage.getItem("logttc")&&console.log.apply(console,arguments)},e=function(t){var n={};try{n=JSON.parse(window.optimizely.get("visitor").custom[t].value)}catch(t){}return n},o=function(t,n){var e={type:"user",attributes:{}};e.attributes[t]=JSON.stringify(n),window.optimizely.push(e)},a=function(t){var n=null;if(t)try{n=(new Date-new Date(t))/1e3}catch(t){}return n},r=function(t,n){return!(!1===n||!t)&&(!0===n||void a(t))},i=function(t,e,o){n("Validate bounds",e+" < "+t+" < "+o);var a=!0;return null!==e&&t<e&&(a=!1),null!==o&&t>o&&(a=!1),a},s=function(e,a){var i=a[e],s=r(i.ts,i.r);i.ts&&!s||(i.ts=(new Date).getTime(),a[e]=i,o(t.start,a),n("Started clock ("+e+")",i))},l=function(e,r,s){var l=r[e],u=s[l.s]||null,c=a(u?u.ts:null),p=i(c,l?l.y:null,l?l.z:null);!l.o&&u&&u.ts&&p?(n("Track stopEntry ("+l.t+")",c,l,u),window.optimizely.push({type:"event",eventName:l.t,tags:{value:c}}),l.o=!0,r[e]=l,o(t.stop,r)):l.o||!u||u.ts?!l.o&&u&&u.ts&&!p?n("Timedelta out of bounds",c,u):n(l.o||u?"Already tracked stopEntry":"Couldnt find start stopEntry"):n("Start stopEntry has null timestamp")},u=function(n,a,r,i){var s=e(t.stop),l={s:n,t:r,o:!1,y:i.min||null,z:i.max||null};s[a]||(s[a]=l,o(t.stop,s))};return{bindTTCTracking:function(n,a,r,i){i=i||{};var s=e(t.start),l={ts:null,r:i.resettable||!1},c=s[n];i.resettable&&c?(c.ts=l.ts,s[n]=c,o(t.start,s)):c||(s[n]=l,o(t.start,s),u(n,a,r,i))},checkEvt:function(n){var o=e(t.start),a=e(t.stop);o[n]&&s(n,o),a[n]&&l(n,a,o)},debug:function(){console.log("Start",e(t.start)),console.log("Stop",e(t.stop))},clear:function(){o(t.start,{}),o(t.stop,{})}}}();window.optimizely.push({type:"registerModule",moduleName:"ttc",module:ttcModule}),window.optimizely.push({type:"addListener",filter:{type:"analytics",name:"trackEvent"},handler:function(t){window.optimizely.get("custom/ttc").checkEvt(t.data.apiName)}});