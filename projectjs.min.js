window.optimizely=window.optimizely||[];var ttcModule=function(){var t={start:"start_ttc_data",stop:"stop_ttc_data"},o=function(){localStorage.getItem("logttc")&&console.log.apply(console,arguments)},e=function(t){var o={};try{o=JSON.parse(window.localStorage.getItem(t+"_"+window.optimizely.get("visitor").visitorId))}catch(t){}return o},n=function(t,o){window.localStorage.setItem(t+"_"+window.optimizely.get("visitor").visitorId,JSON.stringify(o))},a=function(t){var o=null;if(t)try{o=(new Date-new Date(t))/1e3}catch(t){}return o},i=function(t,o){return!(!1===o||!t)&&(!0===o||void a(t))},l=function(t,e,n){o("Validate bounds",e+" < "+t+" < "+n);var a=!0;return null!==e&&t<e&&(a=!1),null!==n&&t>n&&(a=!1),a},r=function(e,a){var l=a[e],r=i(l.ts,l.r);l.ts&&!r||(l.ts=(new Date).getTime(),a[e]=l,n(t.start,a),o("Started clock ("+e+")",l))},s=function(e,i,r){var s=i[e],c=r[s.s]||null,u=a(c?c.ts:null),d=l(u,s?s.y:null,s?s.z:null);!s.o&&c&&c.ts&&d?(o("Track stopEntry ("+s.t+")",u,s,c),window.optimizely.push({type:"event",eventName:s.t,tags:{value:u}}),s.o=!0,i[e]=s,n(t.stop,i)):s.o||!c||c.ts?!s.o&&c&&c.ts&&!d?o("Timedelta out of bounds",u,c):s.o||c?o("Already tracked",s):o("Couldnt find start",s):o("Start stopEntry has null timestamp")},c=function(o,a,i,l){var r=e(t.stop),s={s:o,t:i,o:!1,y:l.min||null,z:l.max||null};r[a]||(r[a]=s,n(t.stop,r))};return{bindTTCTracking:function(o,a,i,l){l=l||{};var r=e(t.start),s={ts:null,r:l.resettable||!1},u=r[o];l.resettable&&u?(u.ts=s.ts,r[o]=u,n(t.start,r)):u||(r[o]=s,n(t.start,r),c(o,a,i,l))},checkEvt:function(o){var n=e(t.start),a=e(t.stop);n[o]&&r(o,n),a[o]&&s(o,a,n)},debug:function(){console.log("Start",e(t.start)),console.log("Stop",e(t.stop))},clear:function(){n(t.start,{}),n(t.stop,{})}}}();window.optimizely.push({type:"registerModule",moduleName:"ttc",module:ttcModule}),window.optimizely.push({type:"addListener",filter:{type:"analytics",name:"trackEvent"},handler:function(t){window.optimizely.get("custom/ttc").checkEvt(t.data.apiName)}});