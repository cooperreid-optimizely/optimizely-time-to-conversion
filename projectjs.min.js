window.optimizely=window.optimizely||[];var ttcModule=function(){var t={start:"start_ttc",stop:"stop_ttc"},e=function(){localStorage.getItem("logttc")&&console.log.apply(console,arguments)},n=function(t){var e={};try{e=JSON.parse(window.optimizely.get("visitor").custom[t].value)}catch(t){}return e},o=function(t,e){var n={type:"user",attributes:{}};n.attributes[t]=JSON.stringify(e),window.optimizely.push(n)},a=function(t){var e=null;if(t)try{e=(new Date-new Date(t))/1e3}catch(t){}return e},i=function(t,e){return!(!1===e||!t)&&(!0===e||void a(t))},r=function(t,n,o){e("Validate bounds",n+" < "+t+" < "+o);var a=!0;return null!==n&&t<n&&(a=!1),null!==o&&t>o&&(a=!1),a},l=function(n,a){var r=a[n],l=i(r.ts,r.r);r.ts&&!l||(r.ts=(new Date).getTime(),a[n]=r,o(t.start,a),e("Started clock ("+n+")",r))},s=function(n,i,l){var s=i[n],u=l[s.s]||null,c=a(u?u.ts:null),p=r(c,s?s.y:null,s?s.z:null);!s.o&&u&&u.ts&&p?(e("Track stopEntry ("+s.t+")",c,s,u),window.optimizely.push({type:"event",eventName:s.t,tags:{value:c}}),s.o=!0,i[n]=s,o(t.stop,i)):s.o||!u||u.ts?!s.o&&u&&u.ts&&!p?e("Timedelta out of bounds",c,u):s.o||u?e("Already tracked",s):e("Couldnt find start",s):e("Start stopEntry has null timestamp")},u=function(e,a,i,r){var l=n(t.stop),s={s:e,t:i,o:!1,y:r.min||null,z:r.max||null};l[a]||(l[a]=s,o(t.stop,l))};return{bindTTCTracking:function(e,a,i,r){r=r||{};var l=n(t.start),s={ts:null,r:r.resettable||!1},c=l[e];r.resettable&&c?(c.ts=s.ts,l[e]=c,o(t.start,l)):c||(l[e]=s,o(t.start,l),u(e,a,i,r))},checkEvt:function(e){var o=n(t.start),a=n(t.stop);o[e]&&l(e,o),a[e]&&s(e,a,o)},debug:function(){console.log("Start",n(t.start)),console.log("Stop",n(t.stop))},clear:function(){o(t.start,{}),o(t.stop,{})}}}();window.optimizely.push({type:"registerModule",moduleName:"ttc",module:ttcModule}),window.optimizely.push({type:"addListener",filter:{type:"analytics",name:"trackEvent"},handler:function(t){window.optimizely.get("custom/ttc").checkEvt(t.data.apiName)}});